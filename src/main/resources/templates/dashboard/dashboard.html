<!doctype html>
<html
  xmlns:th="http://www.thymeleaf.org"
  xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6"
>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Sistema Restaurante</title>

    <!-- Solo Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css"
    />
  </head>
  <body>
    <!-- Contenedor principal -->
    <div class="container-fluid vh-100 p-0">
      <div class="row g-0 h-100">
        <!-- Sidebar - Men칰 izquierdo -->
        <div class="col-md-3 col-lg-2 bg-dark text-white h-100">
          <!-- Logo -->
          <div class="p-3 border-bottom border-secondary">
            <h5 class="mb-1">游꼢 MozSoft</h5>
            <small class="text-white">Sistema de Gesti칩n</small>
          </div>

          <!-- Men칰 simple -->
          <div class="p-3">
            <h6 class="text-white small mb-3">MEN칔 PRINCIPAL</h6>

            <!-- Ventas -->
            <div class="mb-4">
              <p class="text-white small mb-2">VENTAS</p>
              <a
                th:href="@{/facturas/facturar}"
                class="d-block text-white text-decoration-none py-2 px-3 mb-1 rounded"
              >
                <i class="bi bi-cart-plus me-2"></i> Nueva Venta
              </a>
              <a
                th:href="@{/facturas}"
                class="d-block text-white text-decoration-none py-2 px-3 mb-1 rounded"
              >
                <i class="bi bi-receipt me-2"></i> Facturas
              </a>
              <a
                th:href="@{/principal}"
                class="d-block text-white text-decoration-none py-2 px-3 mb-1 rounded"
              >
                <i class="bi bi-people me-2"></i> Clientes(Desarrollo)
              </a>
            </div>

            <!-- Inventario -->
            <div class="mb-4">
              <p class="text-white small mb-2">INVENTARIO</p>
              <a
                th:href="@{/productos}"
                class="d-block text-white text-decoration-none py-2 px-3 mb-1 rounded"
              >
                <i class="bi bi-box me-2"></i> Productos
              </a>
              <a
                th:href="@{/ingredientes}"
                class="d-block text-white text-decoration-none py-2 px-3 mb-1 rounded"
              >
                <i class="bi bi-egg-fried me-2"></i> Ingredientes
              </a>
              <a
                th:href="@{/recetas}"
                class="d-block text-white text-decoration-none py-2 px-3 mb-1 rounded"
              >
                <i class="bi bi-book me-2"></i> Recetas
              </a>
              <a
                th:href="@{/cierres}"
                class="d-block text-white text-decoration-none py-2 px-3 mb-1 rounded"
              >
                <i class="bi bi-clipboard-check me-2"></i> Cierre Diario
              </a>
            </div>

            <!-- Compras -->
            <div class="mb-4">
              <p class="text-white small mb-2">COMPRAS</p>
              <a
                th:href="@{/compras/nueva}"
                class="d-block text-white text-decoration-none py-2 px-3 mb-1 rounded"
              >
                <i class="bi bi-cart-check me-2"></i> Comprar
              </a>
              <a
                th:href="@{/compras}"
                class="d-block text-white text-decoration-none py-2 px-3 mb-1 rounded"
              >
                <i class="bi bi-list-ul me-2"></i> Lista de Compras
              </a>

              <a
                th:href="@{/proveedores}"
                class="d-block text-white text-decoration-none py-2 px-3 mb-1 rounded"
              >
                <i class="bi bi-truck me-2"></i> Proveedores
              </a>
            </div>

            <!-- REPORTES (NUEVA SECCI칍N) -->
            <div class="mb-4">
              <p class="text-white small mb-2">OTROS</p>
              <a
                th:href="@{/reportes/consumo}"
                class="d-block text-white text-decoration-none py-2 px-3 mb-1 rounded"
              >
                <i class="bi bi-clipboard-data me-2"></i> Consumo Diario
              </a>
              <a
                th:href="@{/admin/usuarios}"
                class="d-block text-white text-decoration-none py-2 px-3 mb-1 rounded"
              >
                <i class="bi bi-graph-up me-2"></i> Gestion Usuarios
              </a>
            </div>
          </div>
        </div>

        <!-- Contenido principal -->
        <div class="col-md-9 col-lg-10 h-100 p-0">
          <!-- Topbar - Nombre usuario y cerrar sesi칩n -->
          <div class="bg-white border-bottom p-3">
            <div class="d-flex justify-content-between align-items-center">
              <!-- T칤tulo de p치gina -->
              <h5
                class="mb-0 text-primary"
                th:text="${pageTitle} ?: 'Dashboard'"
              >
                Dashboard
              </h5>
              <!-- En la parte derecha del topbar, antes del usuario -->
              <div class="d-flex align-items-center me-3">
                <span
                  class="badge"
                  th:classappend="${cierreHoy != null && cierreHoy.estado == 'COMPLETADO'} ? 
                                                 'bg-danger' : 
                                                 'bg-success'"
                >
                  <i
                    class="bi"
                    th:classappend="${cierreHoy != null && cierreHoy.estado == 'COMPLETADO'} ? 
                                                   'bi-lock-fill' : 
                                                   'bi-unlock-fill'"
                  ></i>
                  <span
                    th:text="${#temporals.format(fechaHoy, 'dd/MM')}"
                  ></span>
                  <span
                    th:if="${cierreHoy != null}"
                    th:text="' - ' + ${cierreHoy.estado}"
                  ></span>
                </span>
              </div>
              <!-- Usuario y cerrar sesi칩n -->
              <div class="d-flex align-items-center gap-3">
                <span class="text-dark">
                  <i class="bi bi-person-circle me-1"></i>
                  <span th:text="${username ?: 'Usuario'}">Usuario</span>
                </span>
                <form th:action="@{/logout}" method="post" class="mb-0">
                  <button type="submit" class="btn btn-outline-danger btn-sm">
                    <i class="bi bi-box-arrow-right me-1"></i> Cerrar Sesi칩n
                  </button>
                </form>
              </div>
            </div>
          </div>

          <!-- Contenido din치mico -->
          <div class="p-4" style="height: calc(100vh - 70px); overflow-y: auto">
            <!-- Aqu칤 va el contenido espec칤fico de cada p치gina -->

            <!-- Si no hay contenido, muestra dashboard -->
            <!-- Tarjetas simples del dashboard -->
            <div class="row">
              <div class="col-md-3 mb-3">
                <div class="card border-primary">
                  <div class="card-body text-center">
                    <h6 class="card-title">Ventas Hoy</h6>
                    <h3 class="text-success">$0.00</h3>
                    <a
                      th:href="@{/facturas/ventas-hoy}"
                      class="btn btn-outline-primary btn-sm mt-2"
                    >
                      Ver reporte
                    </a>
                  </div>
                </div>
              </div>

              <div class="col-md-3 mb-3">
                <div class="card border-warning">
                  <div class="card-body text-center">
                    <h6 class="card-title">Productos Bajos</h6>
                    <h3 class="text-warning">0</h3>
                    <a
                      th:href="@{/productos}"
                      class="btn btn-outline-warning btn-sm mt-2"
                    >
                      Ver stock
                    </a>
                  </div>
                </div>
              </div>

              <div class="col-md-3 mb-3">
                <div class="card border-info">
                  <div class="card-body text-center">
                    <h6 class="card-title">Clientes</h6>
                    <h3 class="text-info">0</h3>
                    <a
                      th:href="@{/clientes}"
                      class="btn btn-outline-info btn-sm mt-2"
                    >
                      Ver clientes (Desarrollo)
                    </a>
                  </div>
                </div>
              </div>

              <div class="col-md-3 mb-3">
                <div class="card border-success">
                  <div class="card-body text-center">
                    <h6 class="card-title">Proveedores</h6>
                    <h3 class="text-success">0</h3>
                    <a
                      th:href="@{/proveedores}"
                      class="btn btn-outline-success btn-sm mt-2"
                    >
                      Ver proveedores
                    </a>
                  </div>
                </div>
              </div>
            </div>

            <!-- Reportes R치pidos -->
            <div class="row mt-4">
              <div class="col-md-6 mb-3">
                <div class="card">
                  <div class="card-header bg-info text-white">
                    <h6 class="mb-0">
                      <i class="bi bi-clipboard-data me-2"></i>
                      Reporte de Consumo
                    </h6>
                  </div>
                  <div class="card-body">
                    <p class="card-text">
                      Reporte diario de consumo de ingredientes y c치lculo de
                      merma.
                    </p>
                    <a
                      th:href="@{/reportes/consumo}"
                      class="btn btn-info btn-sm"
                    >
                      <i class="bi bi-eye me-1"></i> Ver Reporte
                    </a>
                  </div>
                </div>
              </div>

              <div class="col-md-6 mb-3">
                <div class="card">
                  <div class="card-header bg-primary text-white">
                    <h6 class="mb-0">
                      <i class="bi bi-bar-chart me-2"></i>
                      Reporte de Ventas
                    </h6>
                  </div>
                  <div class="card-body">
                    <p class="card-text">
                      An치lisis de ventas por d칤a, semana o mes.
                    </p>
                    <a th:href="@{/principal}" class="btn btn-primary btn-sm">
                      <i class="bi bi-eye me-1"></i> Ver Reporte (Desarrollo)
                    </a>
                  </div>
                </div>
              </div>
            </div>

            <!-- Acciones r치pidas -->
            <div class="mt-4">
              <h6 class="border-bottom pb-2">Acciones R치pidas</h6>
              <div class="d-flex gap-2">
                <a th:href="@{/facturas/facturar}" class="btn btn-success">
                  <i class="bi bi-cart-plus me-1"></i> Iniciar Venta
                </a>
                <a th:href="@{/compras/nueva}" class="btn btn-primary">
                  <i class="bi bi-cart-check me-1"></i> Registrar Compra
                </a>
                <a th:href="@{/productos}" class="btn btn-warning">
                  <i class="bi bi-box me-1"></i> Ver Inventario
                </a>
                <a th:href="@{/reportes/consumo}" class="btn btn-info">
                  <i class="bi bi-clipboard-data me-1"></i> Reporte Consumo
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Solo Bootstrap JS (sin JS personalizado) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
